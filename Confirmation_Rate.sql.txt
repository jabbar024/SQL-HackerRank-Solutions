SELECT 
    SIGNUPS.USER_ID, 
    CASE
        WHEN COUNT(CONFIRMATIONS.USER_ID) = 0 THEN 0
        ELSE ROUND(SUM(CASE WHEN CONFIRMATIONS.ACTION = 'confirmed' THEN 1 ELSE 0 END) / COUNT(CONFIRMATIONS.USER_ID), 2)
    END AS CONFIRMATION_RATE
FROM 
    SIGNUPS
LEFT OUTER JOIN 
    CONFIRMATIONS
    ON SIGNUPS.USER_ID = CONFIRMATIONS.USER_ID
GROUP BY 
    SIGNUPS.USER_ID;
